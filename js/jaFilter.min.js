!function(t){"use strict";var e=".jaFilter",n={events:"change",containerId:null,rows:null,neverRecount:null,categoryRecount:!0,noEmptyFilters:!0,visibleFilters:[],filtersInDepth:[],countInDepth:[],extraFilters:[],jaAttribute:"jafilter",notInRange:"notInFilterRange",hideOnlyAvailableData:!1,activeFilters:[],filterCounter:[],visibleRows:0,onClickCategory:null,before:function(){},callback:function(){},done:function(){}},i={filter:function(e){var r=e.notInRange,a=!0,o=e.callback;return n.visibleRows=0,e.activeFilters=t.extend({},e.activeFilters),e.$rows.filter(function(){var a=t(this),o=t(this).data(),s=!0;return t.each(e.activeFilters,function(n,r){if(e.filtersInDepth.length>0&&-1!=t.inArray(n,e.filtersInDepth)){if(s=i.depthFilter(a,n,e),!s)return!1}else if(e.activeFilters[n].length>0){"undefined"==typeof o[n]&&e.hideOnlyAvailableData&&(s=!0);var c=[];if("string"==typeof o[n])return c=o[n].split(",").map(function(t){var e=parseInt(t,10);return isNaN(e)?t:e}),s=!1,t.each(r,function(t,e){return-1!=c.indexOf(e)?(s=!0,!1):void 0}),s;if(-1==t.inArray(o[n],r))return s=!1,!1;s=!0}}),e.extraFilters.length>0&&s&&("string"==typeof e.extraFilters&&(e.extraFilters=[e.extraFilters]),t.each(e.extraFilters,function(t,e){var n=e.apply(this,[a]);n||(s=n)})),s?(t(this).removeClass(r),void n.visibleRows++):!0}).addClass(r),o(this,a,e),this.countAttributesForFilter(e,"onfilter"),a},depthFilter:function(e,n,i){var r=i.notInRange,a=!1;return e.find("[data-"+n+"]").each(function(){var e=t(this),o=n.replace("\\",""),s=e.data(o);0==i.activeFilters[n].length?(e.removeClass(r),a=!0):-1==t.inArray(s,i.activeFilters[n])?e.addClass(r):(e.removeClass(r),a=!0)}),a},countAttributesForFilter:function(e,r){var a=[];e.$rows.not("."+e.notInRange).each(function(){var n=t(this),i=t(this).data();t.each(i,function(t,e){"undefined"==typeof a[t]&&(a[t]=[]),"undefined"!=typeof a[t][e]?a[t][e]+=1:a[t][e]=1}),e.countInDepth.length>0&&t.each(e.countInDepth,function(i,r){n.find("[data-"+r+"]").not("."+e.notInRange).each(function(){var e=r.replace("\\",""),n=t(this).data(e);"undefined"==typeof a[r]&&(a[r]=[]),"undefined"!=typeof a[r][n]?a[r][n]+=1:a[r][n]=1})})}),n.filterCounter=a,i.setAttributeCount(a,r)},setAttributeCount:function(e,i){var r=n;"string"==typeof r.neverRecount&&(r.neverRecount=[r.neverRecount]),r.$selector.find('[type="checkbox"]').each(function(){var n=t(this).data(r.jaAttribute);if(-1!=t.inArray(n,r.neverRecount)&&"init"!=i||r.categoryRecount===!0&&r.onClickCategory==n);else{var a,o=t(this).val();a="undefined"==typeof e[n]||"undefined"==typeof e[n][o]?0:e[n][o];var s='[for="'+t(this).attr("id")+'"]';"undefined"==typeof t(s)?t(this).next().text(a):t(s).find("span").text(a),t.isArray(r.noEmptyFilters)&&-1!=t.inArray(n,r.noEmptyFilters)&&0==a||0==r.noEmptyFilters?(t(this).parent().hide(),t(s).hide(),t(s).next().hide()):(t(s).show(),t(this).parent().show(),t(s).next().show()),-1!=t.inArray(n,r.visibleFilters)&&(t(s).show(),t(this).parent().show(),t(s).next().show())}})}},r={make:function(a){"undefined"===a&&t.error("jQuery"+e+" may not be initialized without options."),a=t.extend({},n,a),a.events=a.events.replace(/(\w+)/g,"$1"+e+" ");var o='<style type = "text/css">.'+a.notInRange+"{display:none!important;}</style>";return t(o).appendTo("head"),"string"==typeof a.filtersInDepth&&(a.filtersInDepth=[a.filtersInDepth]),"string"==typeof a.countInDepth&&(a.countInDepth=[a.countInDepth]),a.$containerId=t(a.containerId),a.$rows=t(a.containerId).find(a.rows),this.each(function(){a.$selector=t(this),a.checkboxFilters=t(this).find('[type="checkbox"]'),t(this).find('[type="checkbox"]').each(function(){var e=t(this).data(a.jaAttribute);a.activeFilters[e]=[]}),r.setCache(a),i.countAttributesForFilter(a,"init"),a.checkboxFilters.on(a.events,function(){a.before&&a.before(!0);var e;t(this).is(":checked")&&(n.onClickCategory=t(this).data("jafilter")),a=r.setActiveFilters(this,a),e=i.filter(a),a.done&&(n.onClickCategory=null,a.done(e))})}),this},setActiveFilters:function(e,n){var i=t(e).data(n.jaAttribute),r=t(e).val(),a=isNaN(parseInt(r,10))?r:parseInt(r,10);if("undefined"!=typeof i)if(t(e).is(":checked"))n.activeFilters[i].push(a);else{var o=t.inArray(a,n.activeFilters[i]);o>-1&&n.activeFilters[i].splice(o,1)}return n},resetCache:function(){n.$containerId=t(n.containerId),n.$rows=t(n.containerId).find(n.rows)},getCache:function(t){return(t||"undefined"==typeof t)&&r.resetCache(),n},setCache:function(e){n=t.extend({},n,e)},recount:function(){r.resetCache(),i.countAttributesForFilter(n,"onfilter")},restartFilter:function(){var t=n;n.checkboxFilters.each(function(){t=r.setActiveFilters(this,n)});var e=i.filter(t);t.done&&t.done(e)},destroy:function(){return this.each(function(){t(this).off(e)}),this}};t.fn.jaFilter=function(n){return r[n]?r[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?(t.error("Method "+n+" does not exist on jQuery"+e),this):r.make.apply(this,arguments)}}(jQuery);