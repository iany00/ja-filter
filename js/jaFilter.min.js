!function(t){"use strict";var e=".jaFilter",n={events:"change",containerId:null,rows:null,neverRecount:null,categoryRecount:!0,noEmptyFilters:!0,visibleFilters:[],filtersInDepth:[],countInDepth:[],extraFilters:[],jaAttribute:"jafilter",notInRange:"notInFilterRange",hideOnlyAvailableData:!1,activeFilters:[],filterCounter:[],visibleRows:0,onClickCategory:null,before:function(){},callback:function(){},done:function(){}},i={filter:function(e){{var r=e.notInRange,o=!0;e.callback}return n.visibleRows=0,e.activeFilters=t.extend({},e.activeFilters),e.$rows.filter(function(){var o=t(this),a=t(this).data(),s=!0;return t.each(e.activeFilters,function(n,r){if(e.filtersInDepth.length>0&&-1!=t.inArray(n,e.filtersInDepth)){if(s=i.depthFilter(o,n,e),!s)return!1}else if(e.activeFilters[n].length>0){"undefined"==typeof a[n]&&e.hideOnlyAvailableData&&(s=!0);var c=[];if("string"==typeof a[n])return c=a[n].split(",").map(function(t){var e=parseInt(t,10);return isNaN(e)?t:e}),s=!1,t.each(r,function(t,e){return-1!=c.indexOf(e)?(s=!0,!1):void 0}),s;if(-1==t.inArray(a[n],r))return s=!1,!1;s=!0}}),e.extraFilters.length>0&&s&&("string"==typeof e.extraFilters&&(e.extraFilters=[e.extraFilters]),t.each(e.extraFilters,function(t,e){var n=e.apply(this,[o]);n||(s=n)})),s?(t(this).removeClass(r),void n.visibleRows++):!0}).addClass(r),this.countAttributesForFilter(e,"onfilter"),o},depthFilter:function(e,n,i){var r=i.notInRange,o=!1;return e.find("[data-"+n+"]").each(function(){var e=t(this),a=n.replace("\\",""),s=e.data(a);0==i.activeFilters[n].length?(e.removeClass(r),o=!0):-1==t.inArray(s,i.activeFilters[n])?e.addClass(r):(e.removeClass(r),o=!0)}),o},countAttributesForFilter:function(e,r){var o={};e.$rows.not("."+e.notInRange).each(function(){var n=t(this),i=t(this).data();t.each(i,function(t,e){"undefined"==typeof o[t]&&(o[t]={}),"undefined"!=typeof o[t][e]?o[t][e]+=1:o[t][e]=1}),e.countInDepth.length>0&&t.each(e.countInDepth,function(i,r){n.find("[data-"+r+"]").not("."+e.notInRange).each(function(){var e=r.replace("\\",""),n=t(this).data(e);"undefined"==typeof o[r]&&(o[r]={}),"undefined"!=typeof o[r][n]&&0!=n&&""!=n?o[r][n]+=1:0!=n&&""!=n&&(o[r][n]=1)})})}),n.filterCounter=o,i.setAttributeCount(o,r)},setAttributeCount:function(e,i){var r=n;"string"==typeof r.neverRecount&&(r.neverRecount=[r.neverRecount]),r.$selector.find('[type="checkbox"]').each(function(){var n=t(this).data(r.jaAttribute);if("init"!=i&&null!=r.neverRecount&&-1!=t.inArray(n,r.neverRecount)||r.categoryRecount===!0&&r.onClickCategory==n);else{var o,a=t(this).val();o="undefined"==typeof e[n]||"undefined"==typeof e[n][a]?0:e[n][a];var s=r.$selector.find('[for="'+t(this).attr("id")+'"]');"undefined"==typeof s?t(this).next().text(o):s.find("span").text(o),t.isArray(r.noEmptyFilters)&&-1!=t.inArray(n,r.noEmptyFilters)&&0==o||0==r.noEmptyFilters?(t(this).parent().hide(),s.hide(),s.next().hide()):(s.show(),t(this).parent().show(),s.next().show()),r.visibleFilters.length>0&&-1!=t.inArray(n,r.visibleFilters)&&(s.show(),t(this).parent().show(),s.next().show())}})}},r={make:function(o){"undefined"===o&&t.error("jQuery"+e+" may not be initialized without options."),n=t.extend({},n,o),n.events=n.events.replace(/(\w+)/g,"$1"+e+" ");var a='<style type = "text/css">.'+n.notInRange+"{display:none!important;}</style>";return t(a).appendTo("head"),"string"==typeof n.filtersInDepth&&(n.filtersInDepth=[n.filtersInDepth]),"string"==typeof n.countInDepth&&(n.countInDepth=[n.countInDepth]),n.$containerId=t(n.containerId),n.$rows=t(n.containerId).find(n.rows),this.each(function(){n.$selector=t(this),n.checkboxFilters=t(this).find('[type="checkbox"]'),t(this).find('[type="checkbox"]').each(function(){var e=t(this).data(n.jaAttribute);n.activeFilters[e]=[]}),r.setCache(n),i.countAttributesForFilter(n,"init"),n.checkboxFilters.on(n.events,function(){n.before&&n.before();var e;t(this).is(":checked")&&(n.onClickCategory=t(this).data(n.jaAttribute)),n=r.setActiveFilters(this,n),e=i.filter(n),n.done&&(n.onClickCategory=null,n.done(e))})}),this},setActiveFilters:function(e,n){var i=t(e).data(n.jaAttribute),r=t(e).val(),o=isNaN(parseInt(r,10))?r:parseInt(r,10);if("undefined"!=typeof i)if(t(e).is(":checked"))n.activeFilters[i].push(o);else{var a=t.inArray(o,n.activeFilters[i]);a>-1&&n.activeFilters[i].splice(a,1)}return n},resetCache:function(){n.$containerId=t(n.containerId),n.$rows=t(n.containerId).find(n.rows)},getCache:function(t){return(t||"undefined"==typeof t)&&r.resetCache(),n},setCache:function(e){n=t.extend({},n,e)},recount:function(){r.resetCache(),i.countAttributesForFilter(n,"onfilter")},setFilterCount:function(t){i.setAttributeCount(t,"onfilter")},restartFilter:function(){var t=n;n.checkboxFilters.each(function(){t=r.setActiveFilters(this,n)});var e=i.filter(t);t.done&&t.done(e)},destroy:function(){return this.each(function(){t(this).off(e)}),this}};t.fn.jaFilter=function(n){return r[n]?r[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?(t.error("Method "+n+" does not exist on jQuery"+e),this):r.make.apply(this,arguments)}}(jQuery);